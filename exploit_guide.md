# Moodle Security Scanner: Ethical Usage Guide

## Important Disclaimer

This guide is provided **ONLY** for legitimate security professionals, penetration testers, and system administrators who have explicit permission to test their own Moodle installations or those they have proper authorization to test. Unauthorized security testing against systems you don't own or have permission to test is illegal and unethical.

## Legitimate Testing Scenarios

The Moodle Security Scanner should only be used in the following contexts:

- By educational institutions testing their own Moodle installation
- By security professionals during authorized penetration tests
- By Moodle administrators assessing their system's security posture
- In lab environments for educational purposes

## Pre-Testing Checklist

Before running any tests:

1. Obtain written authorization from the system owner
2. Create a testing plan with clearly defined scope
3. Set up a testing window to minimize disruption
4. Create a backup of the system
5. Consider testing on a staging environment first
6. Notify relevant stakeholders about the testing
7. Have an incident response plan ready

## Using the Scanner Responsibly

### Basic Usage

The scanner can be run with minimal options:

```bash
python moodle_scanner.py -t https://your-moodle-site.com
```

This will perform a basic scan with default settings. For a more controlled approach:

```bash
python moodle_scanner.py -t https://your-moodle-site.com \
  -m version,auth \
  --delay 1.0 \
  --output results.json
```

### Module-Specific Testing

For targeted testing:

#### Version Detection

```bash
python moodle_scanner.py -t https://your-moodle-site.com -m version
```

This identifies the Moodle version, which is useful for determining potential version-specific vulnerabilities.

#### Authentication Testing

```bash
python moodle_scanner.py -t https://your-moodle-site.com -m auth
```

Tests for weak credentials, authentication bypasses, and session management issues.

#### XSS Vulnerability Testing

```bash
python moodle_scanner.py -t https://your-moodle-site.com -m xss
```

Tests for reflected, stored, and DOM-based XSS vulnerabilities across various Moodle components.

#### RCE Vulnerability Testing

```bash
python moodle_scanner.py -t https://your-moodle-site.com -m rce
```

Tests for remote code execution vulnerabilities, particularly in plugins and file upload features.

#### SQL Injection Testing

```bash
python moodle_scanner.py -t https://your-moodle-site.com -m sqli
```

Tests for SQL injection vulnerabilities in GET and POST parameters, focusing on search functionality and form submissions.

#### LFI Vulnerability Testing

```bash
python moodle_scanner.py -t https://your-moodle-site.com -m lfi
```

Tests for local file inclusion vulnerabilities that could expose configuration files or system information.

#### API Security Testing

```bash
python moodle_scanner.py -t https://your-moodle-site.com -m api
```

Tests Moodle's web services and API endpoints for information disclosure and access control issues.

### Advanced Testing Options

For more comprehensive testing:

```bash
python moodle_scanner.py -t https://your-moodle-site.com \
  --cookies "MoodleSession=yoursessioncookie" \
  --proxy http://127.0.0.1:8080 \
  --delay 0.5 \
  --timeout 60 \
  --threads 3 \
  --verbose
```

This configuration:

- Uses authenticated testing with a valid session cookie
- Routes traffic through a proxy for analysis (e.g., Burp Suite)
- Adds delay between requests to reduce server load
- Increases timeout for slower responses
- Limits concurrent threads for more controlled testing
- Provides verbose output for detailed analysis

## Interpreting Results

After running the scanner, you'll receive a summary of findings. For each vulnerability:

1. Verify it manually to confirm it's not a false positive
2. Assess the risk based on severity and your environment
3. Document the finding with evidence
4. Develop remediation steps

## Post-Testing Actions

1. Generate a comprehensive report of findings
2. Prioritize vulnerabilities based on risk
3. Develop a remediation plan
4. Implement fixes
5. Conduct follow-up testing to verify fixes
6. Document lessons learned
7. Update security policies if needed

## Example Workflow for a Controlled Test

1. **Preparation phase**:

   - Set up a testing environment that mirrors production
   - Obtain formal authorization
   - Define testing scope and goals

2. **Reconnaissance phase**:

   - Run version detection

   ```bash
   python moodle_scanner.py -t https://your-moodle-site.com -m version
   ```

3. **Initial testing phase**:

   - Test authentication with low request volume

   ```bash
   python moodle_scanner.py -t https://your-moodle-site.com -m auth --delay 1.0
   ```

4. **Comprehensive testing phase**:

   - Run full scan with appropriate limitations

   ```bash
   python moodle_scanner.py -t https://your-moodle-site.com \
     --delay 0.5 \
     --threads 3 \
     --output full_results.json
   ```

5. **Analysis phase**:

   - Review findings
   - Verify vulnerabilities
   - Prepare recommendations

6. **Reporting phase**:
   - Document confirmed vulnerabilities
   - Provide remediation steps
   - Present findings to stakeholders

Remember: The goal of security testing is to improve the security posture of the system, not to demonstrate exploitation capabilities.
